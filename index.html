<!DOCTYPE HTML>
<!--
	Striped by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
	<title>HFT SensorThings API Dashboard</title>
	<meta charset="utf-8" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<script src="assets/js/jquery.min.js"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	
	<!-- add the Highchart source locally -->
	<script src="./code/hc/highcharts.js"></script>
	<script src="./code/hc/modules/series-label.js"></script>
	<script src="./code/hc/modules/exporting.js"></script>
	<script src="./code/hc/js/themes/grid-light.js"></script>
	<script src="./code/jquery-ui/js/jquery-ui-1.9.2.custom.min.js"></script>


	<!-- add the JStat -->
	<script src="./code/jstat.min.js"></script>
	<!-- add the data table -->
	<link rel="stylesheet" type="text/css" href="./code/DataTables/datatables.min.css" />
	<script type="text/javascript" src="./code/DataTables/datatables.min.js"></script>
</head>

<body class="is-preload">

	<!-- Content -->
	<div id="content">
		<div class="inner">

			<!-- Post -->
			<article class="box post post-excerpt">
				<header>
					<!--
									Note: Titles and subtitles will wrap automatically when necessary, so don't worry
									if they get too long. You can also remove the <p> entirely if you don't
									need a subtitle.
								-->
					<h2>
						<a href="#">HFT SensorThings API Dashboard</a>
					</h2>
					<p>Created by Joe T.S.</p>
				</header>
				<div class="info">
					<!--
									Note: The date should be formatted exactly as it's shown below. In particular, the
									"least significant" characters of the month should be encapsulated in a <span>
									element to denote what gets dropped in 1200px mode (eg. the "uary" in "January").
									Oh, and if you don't need a date for a particular page or post you can simply delete
									the entire "date" element.

								-->
					<span class="date">
						<span class="month">Jul
							<span>y</span>
						</span>
						<span class="day">14</span>
						<span class="year">, 2014</span>
					</span>
				</div>
				<h2>HFT Stuttgart Temperature Data</h2>
				
				<div>
					<strong>Select the Datastream</strong>
				</div>
				<div class="nowrap" id="CesiumStyleChoice">
					<select id="Datastream Selection">
						<option value="op1"> Out-Temperature Aula (Datastream ID: 1) </option>
						<option value="op2"> option 2 </option>
						<option value="op3"> option 3 </option>
					</select>
				</div>
				<div class="nowrap" id="SelectDate">
					<strong>Select the Date (From - To)</strong>
					<br>
					<input type="text" id="dateSelector" style='width:80px'>
					<input type="text" id="dateSelectorTo" style='width:80px'>
					<br>
					<button id="submitDate">Draw Chart</button>
					<button id="submitAggregation">Aggregation Processing</button>
					<button id="drawTable">Draw Table</button>
					<button id="clearDataTable">Clear Table</button>
					<br> Remark: This app-version limits at 100 datastreams or around 4 days)
				</div>
				<div class="backdrop" id="HightChartContainer" draggable="true"> [Chart output here ...]
				</div>
				<div class="nowrap" id="aggregationOut">
					<span>
						<strong>Aggregation Output</strong>
					</span>
					<br> Min :
					<span id="Min_Val"></span>
					<br> Max :
					<span id="Max_Val"></span>
					<br> Sum :
					<span id="Sum_Val"></span>
					<br> Mean :
					<span id="Mean_Val"></span>
					<br> SD :
					<span id="SD_Val"></span>
				</div>
				<div>
					<table id="tableArea" class="display" width="100%"></table>
				</div>
			</article>

			<!-- Post -->
			<article class="box post post-excerpt">
				<header>
					<h2>
						<a href="#">Lorem ipsum dolor sit amet</a>
					</h2>
					<p>Feugiat interdum sed commodo ipsum consequat dolor nullam metus</p>
				</header>
				<div class="info">
					<span class="date">
						<span class="month">Jul
							<span>y</span>
						</span>
						<span class="day">8</span>
						<span class="year">, 2014</span>
					</span>
					<ul class="stats">
						<li>
							<a href="#" class="icon fa-comment">16</a>
						</li>
						<li>
							<a href="#" class="icon fa-heart">32</a>
						</li>
						<li>
							<a href="#" class="icon fa-twitter">64</a>
						</li>
						<li>
							<a href="#" class="icon fa-facebook">128</a>
						</li>
					</ul>
				</div>
				<a href="#" class="image featured">
					<img src="images/pic02.jpg" alt="" />
				</a>
				<p>
					Quisque vel sapien sit amet tellus elementum ultricies. Nunc vel orci turpis. Donec id malesuada metus. Nunc nulla velit,
					fermentum quis interdum quis, tate etiam commodo lorem ipsum dolor sit amet dolore. Quisque vel sapien sit amet tellus
					elementum ultricies. Nunc vel orci turpis. Donec id malesuada metus. Nunc nulla velit, fermentum quis interdum quis,
					convallis eu sapien. Integer sed ipsum ante.
				</p>
			</article>

		</div>
	</div>

	<!-- Sidebar -->
	<div id="sidebar">

		<!-- Logo -->
		<h1 id="logo">
			<a href="#">STRIPED</a>
		</h1>

		<!-- Nav -->
		<nav id="nav">
			<ul>
				<li class="current">
					<a href="#">SensorThings List</a>
				</li>
				<li>
					<a href="#">3D Visualization</a>
				</li>
				<li>
					<a href="#">About Me</a>
				</li>
				<li>
					<a href="#">Contact Me</a>
				</li>
			</ul>
		</nav>

		<!-- Search -->
		<section class="box search">
			<form method="post" action="#">
				<input type="text" class="text" name="search" placeholder="Search" />
			</form>
		</section>

		<!-- Text -->
		<section class="box text-style1">
			<div class="inner">
				<p>
					<strong>Striped:</strong> A free and fully responsive HTML5 site template designed by
					<a href="http://twitter.com/ajlkn">AJ</a> for
					<a href="http://html5up.net/">HTML5 UP</a>
				</p>
			</div>
		</section>



		<!-- Copyright -->
		<ul id="copyright">
			<li>&copy; Untitled.</li>
			<li>Design:
				<a href="http://html5up.net">HTML5 UP</a>
			</li>
		</ul>

	</div>

	<!-- Scripts -->
	
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>

	<script src="DrawHighchart.js"></script>
	<script>
        var dateSelected, selectedYearStr, selectedMonthStr, selectedDateStr;
        var dateSelectedTo, selectedYearStrTo, selectedMonthStrTo, selectedDateStrTo;
        var ds_id;
        $(document).ready(function () {
            //var Defdate = new Date('2017-11-22');
            $("#dateSelector").datepicker({
                minDate: new Date(2015, 12, 1),
                maxDate: "+12D",
                changeMonth: true,
                changeYear: true,
                yearRange: '2016:2017',
            });
            $("#dateSelectorTo").datepicker({
                minDate: new Date(2015, 12, 2),
                maxDate: "+12D",
                changeMonth: true,
                changeYear: true,
                yearRange: '2016:2017',
            });
            $("#dateSelector").datepicker("option", "dateFormat", "yy-mm-dd");
            $("#dateSelector").datepicker("option", "showAnim", "slideDown");
            $("#dateSelector").datepicker().datepicker("setDate", new Date('2015-12-1'));
            $("#dateSelectorTo").datepicker("option", "dateFormat", "yy-mm-dd");
            $("#dateSelectorTo").datepicker("option", "showAnim", "slideDown");
            $("#dateSelectorTo").datepicker().datepicker("setDate", new Date('2015-12-2'));
            //jquery for Time selector from ...
            //Add From - To Time for drawing Highchart
            $("#submitDate").click(function () {
                // read variable from the user - selected value
                dateSelected = $("#dateSelector").val();
                dateSelectedTo = $("#dateSelectorTo").val();
                var date_isoFr = dateSelected + "T00:00:00.000Z";
                var date_isoTo = dateSelectedTo + "T00:00:00.000Z";
                ds_id = 1;

                if (dateSelected === "") {
                    alert("Please select date.");
                } else {
                    selectedYearStr = dateSelected.split("-")[0] * 1;
                    selectedMonthStr = dateSelected.split("-")[1] * 1;
                    selectedDateStr = dateSelected.split("-")[2] * 1;
                    selectedYearStrTo = dateSelectedTo.split("-")[0] * 1;
                    selectedMonthStrTo = dateSelectedTo.split("-")[1] * 1;
                    selectedDateStrTo = dateSelectedTo.split("-")[2] * 1;
                    // Request for the data from STA server
                    // var requestedData = GenSerieData(selectedDateStr, selectedDateStrTo, selectedMonthStr,selectedMonthStrTo, "1");
                    var requestedData = GenSerieDataN(date_isoFr, date_isoTo, ds_id);
                    // GenSerieData (Date From, Date To, Month)

                    setTimeout(function cb() {
                        drawChart(requestedData[0], date_isoFr, date_isoTo, ds_id);
                    }, 500);
                    // Timeout is needed to wait for the font of
                }
            });
            $("#drawTable").click(function () {
                $('#tableArea').DataTable({
                    data: resultRaw,
                    columns: [
                        { title: "Time-ISO" },
                        { title: "Data" }
                    ]
                });
            });
            //Set button function to clear the table
            $("#clearDataTable").click(function () {
                var table = $('#tableArea').DataTable();
                table
                    .clear()
                    .destroy();
                //document.getElementById("tableArea").outerHTML = "";
            });
            // Aggregation function!
            $("#submitAggregation").click(function () {
                dateSelected = $("#dateSelector").val();
                dateSelectedTo = $("#dateSelectorTo").val();
                var date_isoFr = dateSelected + "T00:00:00.000Z";
                var date_isoTo = dateSelectedTo + "T00:00:00.000Z";
                ds_id = 1;
                if (dateSelected === "") {
                    alert("Please select date.");
                } else {
                    selectedYearStr = dateSelected.split("-")[0] * 1;
                    selectedMonthStr = dateSelected.split("-")[1] * 1;
                    selectedDateStr = dateSelected.split("-")[2] * 1;
                    // Request for the data from STA server
                    // var requestedData = GenSerieData(selectedDateStr, selectedDateStrTo, selectedMonthStr,selectedMonthStrTo, "1");
                    var requestedData = GenSerieDataN(date_isoFr, date_isoTo, ds_id);
                    // GenSerieData (Date From, Date To, Month)
                    setTimeout(function cb() {
                        console.log("Processing Aggregation using JStat.js ...");
                        document.getElementById('Mean_Val').innerHTML = jStat.mean(requestedData[1]).toFixed(3) + " Celsius";
                        document.getElementById('SD_Val').innerHTML = jStat.stdev(requestedData[1]).toFixed(3) + " Celsius";
                        document.getElementById('Min_Val').innerHTML = jStat.min(requestedData[1]).toFixed(3) + " Celsius";
                        document.getElementById('Max_Val').innerHTML = jStat.max(requestedData[1]).toFixed(3) + " Celsius";
                        document.getElementById('Sum_Val').innerHTML = jStat.sum(requestedData[1]).toFixed(3) + " Celsius";
                    }, 500);
                    // Timeout is needed to wait for the font of
                }
            });



        });




    </script>
</body>

</html>